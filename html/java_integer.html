<!DOCTYPE html>
<html>
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
		<title>java_integer - Henson's Blog</title>
		<link rel="stylesheet" href="../static/common.css">
		<link rel="stylesheet" href="../static/highlight/tomorrow.min.css">
		<script src="../static/highlight/highlight.min.js"></script>
		<script>hljs.initHighlightingOnLoad();</script>
		<style type="text/css">
		</style>
	</head>
	<body>
		<div class="main">
		<h1 id="javainteger">Java Integer æºä»£ç åˆ†æ</h1>
<h3 id="">æ¦‚è¿°</h3>
<p>ã€€ã€€æœ¬æ–‡æ˜¯å¯¹Java1.8çš„Integerç±»çš„æºä»£ç è¿›è¡Œè¯¦ç»†åˆ†æã€‚<code>Integer</code>æ˜¯å¯¹Javaçš„8ç§<code>åŸºæœ¬ç±»å‹</code>ï¼ˆbyte, short, char, int, long, float, double, boolï¼‰ä¸­çš„<code>int</code>çš„åŒ…è£…ç±»ã€‚å¯¹äºä¸¤è€…ä¹‹é—´çš„è‡ªåŠ¨<code>è£…ç®±</code>ä¸<code>æ‹†ç®±</code>çš„æ“ä½œï¼Œæœ¬æ–‡ä¸åšä»‹ç»ã€‚åªä¼šä»‹ç»æºä»£ç ä¸­çš„ä¸€äº›æœ‰è¶£çš„å‡½æ•°å®ç°ã€cacheæœºåˆ¶å’Œå…¶ä»–çš„ä¸€äº›å†…å®¹ã€‚</p>
<h3 id="string">ä¸stringçš„ç›¸äº’è½¬åŒ–</h3>
<ul>
<li><p>1. <strong><code>toString</code>å‡½æ•°ï¼Œå°†intè½¬ä¸ºstring</strong></p>
<pre><code class="java language-java">public static String toString(int i, int radix) {
    if (radix &lt; Character.MIN_RADIX || radix &gt; Character.MAX_RADIX)
        radix = 10;
    if (radix == 10) {
        return toString(i);
    }
    char buf[] = new char[33];
    boolean negative = (i &lt; 0);
    int charPos = 32;
    if (!negative) {
        i = -i;
    }
    while (i &lt;= -radix) {
        buf[charPos--] = digits[-(i % radix)];
        i = i / radix;
    }
    buf[charPos] = digits[-i];
    if (negative) {
        buf[--charPos] = '-';
    }
    return new String(buf, charPos, (33 - charPos));
}
</code></pre>
<p><code>toString</code>å‡½æ•°ï¼Œå°†ä¸€ä¸ªæ•´æ•°ï¼Œè½¬ä¸ºæŒ‡å®šåŸºæ•°ï¼ˆradixï¼‰çš„å­—ç¬¦ä¸²è¡¨ç¤ºã€‚radixçš„å–å€¼èŒƒå›´ä¸º2 ï½ 36ï¼Œè¶…å‡ºèŒƒå›´é»˜è®¤ä¸º10ã€‚ä»£ç å®ç°åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼šåŸºæ•°ä¸º10çš„å’Œå…¶ä»–çš„ã€‚ä»£ç ä¸­ï¼Œå¯¹åŸºæ•°ä¸º10çš„æƒ…å†µï¼Œä¸“é—¨åšäº†ç‰¹æ®Šå¤„ç†ã€‚æˆ‘ä»¬å…ˆæ¥åˆ†æä»¥ä¸‹å…¶ä»–çš„æƒ…å†µã€‚</p>
<ul>
<li>1. é¦–å…ˆåˆ†é…ä¸€ä¸ªé•¿åº¦ä¸º33çš„å­—ç¬¦æ•°ç»„ï¼Œå› ä¸ºä¸€ä¸ªintçš„å­—ç¬¦ä¸²çš„è¡¨ç¤ºæœ€å¤šä¸º32ï¼ˆ2è¿›åˆ¶è¡¨ç¤ºï¼‰ï¼ŒåŠ ä¸Šä¸€ä¸ªç¬¦å·ä½ï¼›</li>
<li>2. å¦‚æœå‚æ•°æ˜¯æ­£æ•°ï¼Œè½¬ä¸ºè´Ÿæ•°å¤„ç†ã€‚å› ä¸ºï¼Œä»£ç é’ˆå¯¹æ­£æ•°å’Œè´Ÿæ•°æ˜¯ç»Ÿä¸€å¤„ç†çš„ï¼Œè€Œä¸”ï¼Œæœ€å°çš„è´Ÿæ•°æ— æ³•è½¬æˆæ­£æ•°ï¼ˆintèƒ½è¡¨ç¤ºçš„æœ€å¤§æ­£æ•°æ¯”æœ€å°è´Ÿæ•°ç»å¯¹å€¼å°1ï¼‰ï¼Œæ‰€ä»¥ï¼Œåªèƒ½ç»Ÿä¸€è½¬ä¸ºè´Ÿæ•°å¤„ç†ï¼›</li>
<li>3. ä½¿ç”¨whileå¾ªç¯ï¼Œä¾æ¬¡å¯¹radixå–ä½™ï¼ŒçŸ¥é“å‰©ä½™çš„æ•°ä¸è¶³radixï¼›</li>
<li>4. æœ€åæ ¹æ®æ­£è´Ÿï¼Œæ·»åŠ å‰é¢çš„ç¬¦å·è¡¨ç¤ºï¼Œè¿”å›ç»“æœã€‚</li></ul>
<p>ä¸‹é¢æ¥çœ‹ä¸€ä¸‹åŸºæ•°ä¸º10çš„ä»£ç å®ç°ã€‚</p>
<pre><code class="java language-java">public static String toString(int i) {
    if (i == Integer.MIN_VALUE)
        return "-2147483648";
    int size = (i &lt; 0) ? stringSize(-i) + 1 : stringSize(i);
    char[] buf = new char[size];
    getChars(i, size, buf);
    return new String(buf, true);
}
static void getChars(int i, int index, char[] buf) {
    int q, r;
    int charPos = index;
    char sign = 0;
    if (i &lt; 0) {
        sign = '-';
        i = -i;
    }
    // Generate two digits per iteration
    while (i &gt;= 65536) {
        q = i / 100;
    // really: r = i - (q * 100);
        r = i - ((q &lt;&lt; 6) + (q &lt;&lt; 5) + (q &lt;&lt; 2));
        i = q;
        buf [--charPos] = DigitOnes[r];
        buf [--charPos] = DigitTens[r];
    }
    // Fall thru to fast mode for smaller numbers
    // assert(i &lt;= 65536, i);
    for (;;) {
        q = (i * 52429) &gt;&gt;&gt; (16+3);
        r = i - ((q &lt;&lt; 3) + (q &lt;&lt; 1));  // r = i-(q*10) ...
        buf [--charPos] = digits [r];
        i = q;
        if (i == 0) break;
    }
    if (sign != 0) {
        buf [--charPos] = sign;
    }
}
</code></pre>
<p>è¿™ä¸ªå‡½æ•°è¿”å›ä¸€ä¸ªæ•´æ•°çš„10è¿›åˆ¶stringè¡¨ç¤ºã€‚å®ç°æ€è·¯ï¼šå…ˆæ£€æŸ¥æ˜¯å¦æ˜¯æœ€å°çš„intï¼ˆå› ä¸ºï¼Œåé¢çš„å®ç°åœ¨æœ€å°intæ—¶ä¼šå¤±è´¥ï¼‰ï¼Œç„¶åæ±‚stringè¡¨ç¤ºçš„é•¿åº¦ï¼Œæœ€åè°ƒç”¨<code>getChars</code>å‡½æ•°å¾—åˆ°ç»“æœã€‚</p>
<p>getCharså‡½æ•°åˆ†ä¸ºä¸¤éƒ¨åˆ†é€»è¾‘ï¼šå¤§äºç­‰äº65536å’Œå°äºçš„ã€‚å¯¹äºå¤§äºçš„æƒ…å†µï¼šæ¯ä¸¤ä½è¿›è¡Œè¿­ä»£ï¼Œé€šè¿‡<code>æ‰“è¡¨</code>æ¥è·å¾—åä½å’Œä¸ªä½çš„æ•°ï¼›å¯¹äºå°äºçš„æƒ…å†µï¼šé€šè¿‡å°†<code>é™¤æ³•å˜æˆä¹˜æ³•</code>çš„æ–¹å¼ï¼Œæ¥å¿«é€Ÿè¿­ä»£ã€‚æºä»£ç çš„æ³¨é‡Šä¸­ï¼Œå°†è¿™ç§æ–¹å¼ç§°ä¸º<code>invariant division by multiplication</code>ï¼Œæ¯æ¬¡é™¤ä»¥10æ¥è·å–æ•°å­—ã€‚<code>(i * 52429) &gt;&gt;&gt; (16+3)</code> è¿™è¡Œä»£ç ï¼Œå°±æ˜¯å°†é™¤10è½¬ä¸ºè¾ƒä¸ºé«˜æ•ˆçš„ç§»ä½æ“ä½œï¼Œå…¶ä¸­<code>* 52429</code>æœªæ¥ä¹Ÿå¯èƒ½è½¬ä¸ºç§»ä½æ“ä½œï¼Œå°±åƒä»£ç ä¸­å°†å¾ˆå¤šä¹˜æ³•è½¬ä¸ºç§»ä½ä¸€æ ·ã€‚ï¼ˆæ¯”å¦‚ï¼Œä¸‹ä¸€è¡Œä»£ç ä¸­çš„ä¹˜10å°±è½¬åŒ–ä¸ºäº†å‡ æ¬¡ç§»ä½æ“ä½œï¼‰ã€‚</p>
<p>åœ¨ä»£ç ä¸­ï¼Œæˆ‘ä»¬å‘ç°æœ‰ä¸€ä¸ªå¾ˆæœ‰æ„æ€çš„å‡½æ•°ï¼Œè·å–intå¯¹åº”stringé•¿åº¦çš„å‡½æ•°<code>stringSize</code>ï¼Œå®ƒçš„å®ç°å¾ˆç®€å•ç²—æš´ï¼š</p>
<pre><code class="java language-java">final static int [] sizeTable = { 9, 99, 999, 9999, 99999, 999999, 9999999,
                                  99999999, 999999999, Integer.MAX_VALUE };
// Requires positive x
static int stringSize(int x) {
    for (int i=0; ; i++)
        if (x &lt;= sizeTable[i])
            return i+1;
}
</code></pre>
<p>ç›´æ¥æ ¹æ®å¤§å°ï¼Œæ¥è¿”å›é•¿åº¦ï¼Œç®€å•æœ‰æ•ˆã€‚</p></li>
<li><p>2. <strong><code>parseInt</code>å‡½æ•°ï¼Œå°†stringè½¬ä¸ºint</strong></p>
<pre><code class="java language-java">public static int parseInt(String s, int radix) throws NumberFormatException {
    // è¿™é‡Œçœå»äº†ä¸€äº›è¾¹ç•Œå’Œå¼‚å¸¸çš„æ£€æŸ¥
    int result = 0;
    boolean negative = false;
    int i = 0, len = s.length();
    int limit = -Integer.MAX_VALUE;
    int multmin;
    int digit;
    if (len &gt; 0) {
        char firstChar = s.charAt(0);
        if (firstChar &lt; '0') { // Possible leading "+" or "-"
            if (firstChar == '-') {
                negative = true;
                limit = Integer.MIN_VALUE;
            } else if (firstChar != '+')
                throw NumberFormatException.forInputString(s);
            if (len == 1) // Cannot have lone "+" or "-"
                throw NumberFormatException.forInputString(s);
            i++;
        }
        multmin = limit / radix;
        while (i &lt; len) {
            // Accumulating negatively avoids surprises near MAX_VALUE
            digit = Character.digit(s.charAt(i++),radix);
            if (digit &lt; 0) {
                throw NumberFormatException.forInputString(s);
            }
            if (result &lt; multmin) {
                throw NumberFormatException.forInputString(s);
            }
            result *= radix;
            if (result &lt; limit + digit) {
                throw NumberFormatException.forInputString(s);
            }
            result -= digit;
        }
    } else {
        throw NumberFormatException.forInputString(s);
    }
    return negative ? result : -result;
}
</code></pre>
<p>è¯¥å‡½æ•°æ˜¯æˆ‘ä»¬å¸¸ç”¨çš„<code>valueOf</code>çš„å®é™…å®ç°ï¼Œå°†ä¸€ä¸ªå­—ç¬¦ä¸²è½¬ä¸ºç›¸åº”çš„æ•´æ•°ã€‚æ•´ä½“å®ç°æ¯”è¾ƒç®€å•ï¼šå…ˆåˆ¤æ–­ç¬¬ä¸€ä½æ˜¯å¦ä¸ºç¬¦å·ä½'+/-'ï¼Œç„¶åç”¨whileå¾ªç¯éå†å‰©ä¸‹çš„æ¯ä¸€ä½ã€‚å…¶ä¸­ï¼Œåœ¨å°†æ¯ä¸€ä¸ªå­—ç¬¦è½¬ä¸ºæ•°å­—æ—¶ï¼Œè°ƒç”¨çš„æ˜¯<code>Character</code>é‡Œé¢çš„æ–¹æ³•ï¼Œå…·ä½“æŸ¥çœ‹æºä»£ç å¯ä»¥å‘ç°ï¼Œé‡Œé¢çš„åŸºæœ¬é€»è¾‘ä¹Ÿæ˜¯é‡‡ç”¨æ‰“è¡¨çš„æ–¹å¼å®ç°ã€‚</p></li>
</ul>
<h3 id="-1">ä½è¿ç®—</h3>
<p>Integeræºä»£ç ä¸­æœ‰å¾ˆå¤šä½è¿ç®—çš„å‡½æ•°ï¼Œå¤§éƒ¨åˆ†éƒ½æ˜¯å‚è€ƒ<em>ã€ŠHacker's Delightã€‹</em>ä¸­çš„ç®—æ³•æ¥å®ç°çš„ã€‚å¾ˆå€¼å¾—ç ”ç©¶ã€‚ä¸‹é¢å¯¹æ¯ä¸€ä¸ªå‡½æ•°è¿›è¡Œåˆ†æã€‚</p>
<ul>
<li><p>1. <strong><code>highestOneBit</code>å‡½æ•°ï¼Œå¯»æ‰¾æœ€é«˜ä½çš„1</strong></p>
<pre><code class="java language-java">public static int highestOneBit(int i) {
    // HD, Figure 3-1
    i |= (i &gt;&gt;  1);
    i |= (i &gt;&gt;  2);
    i |= (i &gt;&gt;  4);
    i |= (i &gt;&gt;  8);
    i |= (i &gt;&gt; 16);
    return i - (i &gt;&gt;&gt; 1);
}
</code></pre>
<p>è¯¥å‡½æ•°è¿”å›ä¸€ä¸ªæ•´æ•°ï¼Œå…¶bitä½è¡¨ç¤ºåªåŒ…å«ä¸€ä¸ª1ï¼Œæˆ–è€…ä¸åŒ…å«1ã€‚å¹¶ä¸”ï¼Œ1æ‰€åœ¨çš„ä½ç½®å’Œä¼ å…¥å‚æ•°içš„æœ€é«˜ä½1æ‰€åœ¨ä½ç½®ç›¸åŒã€‚</p>
<p>ç®—æ³•æ€æƒ³ï¼šä»æœ€é«˜ä½1çš„ä½ç½®å¼€å§‹ï¼ŒæŠŠåé¢çš„ä½éƒ½å˜ä¸º1ï¼Œå˜æˆ<code>00..011111..111</code>çš„è¿™ç§å½¢å¼ï¼Œè®°ä¸ºxï¼›ç„¶åï¼Œæ•´ä½“å³ç§»ä¸€ä½ï¼Œè®°ä¸ºyï¼›æœ€åx - yå¾—åˆ°æœ€ç»ˆç»“æœã€‚</p>
<p>æ³¨æ„ï¼Œä»£ç ä¸­çš„<code>ç®—æœ¯å³ç§»</code>å’Œ<code>é€»è¾‘å³ç§»</code>çš„ä½¿ç”¨åŒºåˆ«ã€‚</p></li>
<li><p>2. <strong><code>lowestOneBit</code>å‡½æ•°ï¼Œå¯»æ‰¾æœ€ä½ä½çš„1</strong></p>
<pre><code class="java language-java">public static int lowestOneBit(int i) {
    // HD, Section 2-1
    return i &amp; -i;
}
</code></pre>
<p>è¿™ä¸ªå‡½æ•°å’Œä¸Šé¢çš„ç±»ä¼¼ï¼Œåªä¸è¿‡è¿”å›çš„æ˜¯æœ€ä½ä½çš„1ã€‚å®ç°æ€è·¯å¾ˆç®€å•ï¼Œç›´æ¥å’Œå®ƒçš„è´Ÿæ•°åš<code>ä½ä¸</code>è¿ç®—å°±èƒ½å¾—åˆ°ç»“æœã€‚</p>
<p>åŸç†ï¼šè®¡ç®—æœºä¸­ï¼Œé€šå¸¸è´Ÿæ•°éƒ½æ˜¯é‡‡ç”¨<code>è¡¥ç </code>çš„å½¢å¼è¡¨ç¤ºï¼ˆæœ€é«˜ä½ä¸ºç¬¦å·ä½ï¼Œè¡¥ç å°±æ˜¯ï¼š<code>æŒ‰ä½å–ååŠ 1</code>ï¼‰ã€‚å‡è®¾ä¸€ä¸ªæ•´æ•°çš„bitè¡¨ç¤ºä¸º<code>xx..x10..0</code>,åˆ™å®ƒçš„è´Ÿæ•°è¡¨ç¤ºä¸º<code>yy..y10..0</code>ï¼Œå…¶ä¸­ï¼Œxéƒ¨åˆ†å’Œyéƒ¨åˆ†éƒ½æ˜¯ç›¸åçš„ã€‚å› æ­¤ï¼ŒæŒ‰ä½ä¸å°±èƒ½å¾—åˆ°ç»“æœã€‚   </p></li>

<li><p>3. <strong><code>numberOfLeadingZeros</code>å‡½æ•°ï¼Œå¯»æ‰¾å‰å¯¼0çš„ä¸ªæ•°</strong></p>
<pre><code class="java language-java">public static int numberOfLeadingZeros(int i) {
    // HD, Figure 5-6
    if (i == 0)
        return 32;
    int n = 1;
    if (i &gt;&gt;&gt; 16 == 0) { n += 16; i &lt;&lt;= 16; }
    if (i &gt;&gt;&gt; 24 == 0) { n +=  8; i &lt;&lt;=  8; }
    if (i &gt;&gt;&gt; 28 == 0) { n +=  4; i &lt;&lt;=  4; }
    if (i &gt;&gt;&gt; 30 == 0) { n +=  2; i &lt;&lt;=  2; }
    n -= i &gt;&gt;&gt; 31;
    return n;
}
</code></pre>
<p>è¿™ä¸ªå‡½æ•°è¿”å›ä¸€ä¸ªæ•´æ•°çš„bitä½è¡¨ç¤ºçš„å‰å¯¼0çš„ä¸ªæ•°ã€‚</p>
<p>å®ç°æ€è·¯ï¼šåˆ†æ‰¹ç»Ÿè®¡ã€‚å…ˆç»Ÿè®¡å‰16ä½é‡Œçš„0çš„ä¸ªæ•°ï¼Œç„¶åç»Ÿè®¡è¿‡çš„16ä½å‘å·¦ç§»å‡ºã€‚ç„¶åç»Ÿè®¡åé¢8ä½ã€4ä½ã€2ä½ã€1ä½ã€‚</p></li>
<li><p>4. <strong><code>numberOfTrailingZeros</code>å‡½æ•°ï¼Œå¯»æ‰¾åç¼€0çš„ä¸ªæ•°</strong></p>
<pre><code class="java language-java">public static int numberOfTrailingZeros(int i) {
    // HD, Figure 5-14
    int y;
    if (i == 0) return 32;
    int n = 31;
    y = i &lt;&lt;16; if (y != 0) { n = n -16; i = y; }
    y = i &lt;&lt; 8; if (y != 0) { n = n - 8; i = y; }
    y = i &lt;&lt; 4; if (y != 0) { n = n - 4; i = y; }
    y = i &lt;&lt; 2; if (y != 0) { n = n - 2; i = y; }
    return n - ((i &lt;&lt; 1) &gt;&gt;&gt; 31);
}
</code></pre>
<p>è¿™ä¸ªå‡½æ•°è¿”å›ä¸€ä¸ªæ•´æ•°çš„bitä½è¡¨ç¤ºçš„åç¼€0çš„ä¸ªæ•°ã€‚å®ç°çš„æ€è·¯åŸºæœ¬å’Œå‰é¢çš„å‡½æ•°ç›¸åï¼šå…ˆåˆ¤æ–­æ˜¯å¦ç­‰äº0ï¼Œç„¶åä¾æ¬¡ç»Ÿè®¡åé¢çš„16ä½ã€8ä½ã€4ä½ã€2ä½ã€1ä½ã€‚</p></li>
<li><p>5. <strong><code>bitCount</code>å‡½æ•°ï¼Œç»Ÿè®¡ä¸€ä¸ªæ•°ä¸­æ‰€å«1çš„ä¸ªæ•°</strong></p>
<pre><code class="java language-java">public static int bitCount(int i) {
    // HD, Figure 5-2
    i = i - ((i &gt;&gt;&gt; 1) &amp; 0x55555555);  // â‘ 
    i = (i &amp; 0x33333333) + ((i &gt;&gt;&gt; 2) &amp; 0x33333333);  // â‘¡
    i = (i + (i &gt;&gt;&gt; 4)) &amp; 0x0f0f0f0f; // â‘¢
    i = i + (i &gt;&gt;&gt; 8);  // â‘£
    i = i + (i &gt;&gt;&gt; 16); // â‘¤
    return i &amp; 0x3f;  // å¤šä¸€æ¬¡ '&amp;' æ“ä½œ
}
</code></pre>
<p>è¯¥å‡½æ•°è¿”å›ä¸€ä¸ªæ•´æ•°çš„bitä½è¡¨ç¤ºä¸­1çš„ä¸ªæ•°ã€‚å®ç°çš„éå¸¸å·§å¦™ï¼Œåœ¨å¤§ä¸€çš„è¯¾ä¸Šå°±é‡åˆ°è¿‡ï¼Œä¸€ç›´æ²¡æœ‰å¥½å¥½åˆ†æè¿‡ã€‚æ¥ä¸‹æ¥ï¼Œè¯¦ç»†åˆ†æä¸€ä¸‹ä»£ç æ€è·¯ã€‚</p>
<p><strong>ç®—æ³•æ€æƒ³</strong>ï¼šåˆ†æ‰¹ç»Ÿè®¡ã€‚å…ˆç»Ÿè®¡<code>æ¯2ä¸ª</code>bitä½çš„ï¼Œç„¶åç»Ÿè®¡<code>æ¯4ä¸ª</code>bitä½çš„ï¼Œæ¥ç€8ä¸ªã€16ä¸ªã€32ä¸ªï¼Œå¾—åˆ°ç»“æœã€‚æŒ‰ç…§è¿™ç§æ€è·¯å†™ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="java language-java">public static int myBitCount(int i) {
    i = ((i &gt;&gt;&gt; 1) &amp; 0x55555555) + (i &amp; 0x55555555);  // â‘  å°‘ä¸€æ¬¡ '&amp;' æ“ä½œ
    i = ((i &gt;&gt;&gt; 2) &amp; 0x33333333) + (i &amp; 0x33333333);  // â‘¡ ä¸€æ ·
    i = ((i &gt;&gt;&gt; 4) &amp; 0x0f0f0f0f) + (i &amp; 0x0f0f0f0f);  // â‘¢ å°‘ä¸€æ¬¡ '&amp;' æ“ä½œ
    i = ((i &gt;&gt;&gt; 8) &amp; 0x00ff00ff) + (i &amp; 0x00ff00ff);  // â‘£  å°‘ä¸¤æ¬¡ '&amp;' æ“ä½œ
    i = ((i &gt;&gt;&gt; 16) &amp; 0x0000ffff) + (i &amp; 0x0000ffff);  // â‘¤ å°‘ä¸¤æ¬¡ '&amp;' æ“ä½œ
    return i;
}
</code></pre>
<p>ä¸Šé¢ä¸¤ç§å®ç°çš„æ€è·¯æ˜¯ä¸€æ ·çš„ã€‚ä¸è¿‡ï¼Œæˆ‘çš„å®ç°æ¯”æºç ç¨å¾®ä½æ•ˆç‚¹ğŸ˜‚ï¼ˆæºç æ“ä½œæ¬¡æ•°æ¯”æˆ‘çš„å°‘ï¼‰ã€‚ç¬¬ä¸€æ¬¡æ“ä½œï¼Œæºç ä¸­é‡‡ç”¨å‡æ³•çš„æ–¹å¼æ¯”ä¸‹é¢çš„å°‘ä¸€æ¬¡ä½ä¸æ“ä½œï¼ˆä¸¤ç§å®ç°çš„ç»“æœä¸€æ ·ï¼Œè¯»è€…å¯ä»¥æ¨¡æ‹Ÿè¯•è¯•ï¼‰ã€‚å‰©ä¸‹çš„å‡ æ­¥åŸºæœ¬æ˜¯ä¸€æ ·çš„ï¼ˆç¬¬2æ­¥ä¸€æ ·ï¼Œç¬¬3æ­¥å°‘ä¸€æ¬¡ï¼Œç¬¬4å’Œ5æ­¥å°‘ä¸¤æ¬¡ï¼‰ã€‚è¿™æ ·æ“ä½œæ˜¯åŸºäºï¼šä¸€ä¸ªæ•´æ•°çš„1çš„ä¸ªæ•°æœ€å¤šä¸º32ä¸ªï¼Œèƒ½ç”¨ä¸€ä¸ªbyteè¡¨ç¤ºã€‚æ‰€ä»¥ï¼Œæºç ä¸­çš„åå‡ æ­¥éƒ½å¿½ç•¥äº†é«˜ä½çš„æœ€ç»ˆç»“æœï¼ŒåªæŠŠå…¶å³ç§»åˆ°ä½ä½ç›¸åŠ ï¼Œè®©æœ€ç»ˆç»“æœå­˜åœ¨ä½ä½ï¼Œç„¶åå†é€šè¿‡<code>i &amp; 0x3f</code>å–å‡ºæ¥ã€‚</p></li>
<li><p>6. <strong><code>rotateLeft</code>å’Œ<code>rotateRight</code>å‡½æ•°ï¼Œå·¦æ—‹å’Œå³æ—‹å‡½æ•°</strong></p>
<pre><code class="java language-java">public static int rotateLeft(int i, int distance) {
    return (i &lt;&lt; distance) | (i &gt;&gt;&gt; -distance);
}
public static int rotateRight(int i, int distance) {
    return (i &gt;&gt;&gt; distance) | (i &lt;&lt; -distance);
}
</code></pre>
<p>è¿™ä¸¤ä¸ªå‡½æ•°ï¼Œå°†ä¸€ä¸ªæ•´æ•°çš„bitä½è¡¨ç¤ºï¼Œæ ¹æ®distanceè¿›è¡Œæ—‹è½¬ã€‚ä»¥å·¦æ—‹ä¸ºä¾‹ï¼šå‡è®¾ä¸€ä¸ªæ•°çš„bitä½è¡¨ç¤ºä¸ºï¼š<code>abcd..hijklmn</code>ï¼Œå·¦æ—‹çš„distanceä¸º4ï¼Œé‚£ä¹ˆå·¦æ—‹åçš„ç»“æœåº”è¯¥ä¸º<code>..hijklmnabcd</code>ã€‚å®ç°çš„æ€è·¯å¾ˆç®€å•ï¼š<code>å·¦ç§»distance | å³ç§»(32 - distance)</code>å³å¯ã€‚</p>
<p>æ³¨æ„ï¼šç”±äºä¸€ä¸ªæ•´æ•°ä¸º32ä½bitsï¼Œæ‰€ä»¥å·¦ç§»å’Œå³ç§»æ“ä½œæœ€å¤šåªèƒ½ç§»32ä½ã€‚å› æ­¤ï¼Œå®é™…çš„distanceéœ€è¦å¯¹32å–ä½™ï¼ˆjavaè¯­è¨€åè‡ªåŠ¨æ‰§è¡Œï¼Œæˆ‘ä»¬ä¸éœ€è¦ç®¡ï¼‰ã€‚ä»¥å·¦æ—‹ä¸ºä¾‹ï¼Œå¦‚ä¸‹æ¼”ç¤ºï¼š</p>
<ul>
<li>1. éœ€è¦æ±‚<code>(i &lt;&lt; distance) | (i &gt;&gt;&gt; (32 - distance))</code></li>
<li>2. ç”±äº<code>i &gt;&gt;&gt; (32 - distance)</code> =&gt; <code>i &gt;&gt;&gt; (32 + (-distance))</code> =&gt; <code>i &gt;&gt;&gt; -distance</code></li>
<li>3. å¾—åˆ°<code>(i &lt;&lt; distance) | (i &gt;&gt;&gt; -distance)</code></li></ul></li>
<li><p>7. <strong><code>reverse</code>å‡½æ•°ï¼Œåè½¬æ•´æ•°çš„bitä½</strong></p>
<pre><code class="java language-java">public static int reverse(int i) {
    // HD, Figure 7-1
    i = (i &amp; 0x55555555) &lt;&lt; 1 | (i &gt;&gt;&gt; 1) &amp; 0x55555555;   // æ¯1ä½
    i = (i &amp; 0x33333333) &lt;&lt; 2 | (i &gt;&gt;&gt; 2) &amp; 0x33333333;   // æ¯2ä½
    i = (i &amp; 0x0f0f0f0f) &lt;&lt; 4 | (i &gt;&gt;&gt; 4) &amp; 0x0f0f0f0f;   // æ¯4ä½
    i = (i &lt;&lt; 24) | ((i &amp; 0xff00) &lt;&lt; 8) |  // æ¯8ä½
        ((i &gt;&gt;&gt; 8) &amp; 0xff00) | (i &gt;&gt;&gt; 24);  // æ¯16ä½
    return i;
}
</code></pre>
<p>è¯¥å‡½æ•°å°†ä¸€ä¸ªæ•´æ•°çš„bitä½è¡¨ç¤ºé¢ å€’åè¿”å›ã€‚å®ç°çš„æ€è·¯å’ŒbitCountå‡½æ•°çš„æ€è·¯ç›¸ä¼¼ï¼šå…ˆæ¯1ä½è¿›è¡Œåè½¬ï¼Œç„¶åæ¯2ä½è¿›è¡Œåè½¬ï¼Œæ¥ç€æ¯4ä½ã€æ¯8ä½ã€æ¯16ä½ï¼Œæœ€åå¾—åˆ°ç»“æœã€‚ä¸‹é¢ä»¥16ä¸ªbitsç¤ºä¾‹ï¼Œå‡è®¾åŸæ•°æ˜¯<code>abcdefghijklmnop</code>ï¼Œåè½¬åçš„æ•°åº”è¯¥æ˜¯<code>ponmlkjihgfedcba</code>:
<center><code>a b c d e f g h i j k l m n o p</code> æ¯1ä½</center>
<center><code>ba dc fe hg ji lk nm po</code> æ¯2ä½</center>
<center><code>dcba hgfe lkji ponm</code> æ¯4ä½</center>
<center><code>hgfedcba ponmlkji</code>   æ¯8ä½</center>
<center><code>ponmlkjihgfedcba</code>    å¾—åˆ°ç»“æœ</center></p></li>
<li><p>8. <strong><code>signum</code>å‡½æ•°ï¼Œç¬¦å·å‡½æ•°</strong></p>
<pre><code class="java language-java">public static int signum(int i) {
    // HD, Section 2-7
    return (i &gt;&gt; 31) | (-i &gt;&gt;&gt; 31);
}
</code></pre>
<p>è¯¥å‡½æ•°è¿”å›ä¸€ä¸ªæ•°çš„ç¬¦å·ï¼Œå¦‚æœæ˜¯æ­£æ•°ï¼Œè¿”å›1ï¼›æ˜¯0è¿”å›0ï¼Œæ˜¯è´Ÿæ•°ï¼Œè¿”å›-1ï¼›</p>
<p>ç®—æ³•å……åˆ†åˆ©ç”¨äº†ç®—æœ¯å³ç§»å’Œé€»è¾‘å³ç§»çš„åŒºåˆ«ã€‚æ¯”è¾ƒå®¹æ˜“ç†è§£ã€‚</p></li>
<li><p>9. <strong><code>reverseBytes</code>å‡½æ•°ï¼ŒæŒ‰byteåè½¬</strong></p>
<pre><code class="java language-java">public static int reverseBytes(int i) {
    return ((i &gt;&gt;&gt; 24)           ) |
           ((i &gt;&gt;   8) &amp;   0xFF00) |
           ((i &lt;&lt;   8) &amp; 0xFF0000) |
           ((i &lt;&lt; 24));
}
</code></pre>
<p>è¿™ä¸ªå‡½æ•°ï¼Œå’Œä¹‹å‰çš„reverseå‡½æ•°ç›¸ä¼¼ï¼Œç›¸å½“äºä»æ¯8ä½ï¼ˆ1byte=8bitsï¼‰å¼€å§‹åè½¬ã€‚å®ç°ä¹Ÿå¾ˆæš´åŠ›ã€ç›´è§‚ã€‚</p></li>
</ul>
<h3 id="cache">cache</h3>
<pre><code class="java language-java">public static Integer valueOf(int i) {
    if (i &gt;= IntegerCache.low &amp;&amp; i &lt;= IntegerCache.high)
        return IntegerCache.cache[i + (-IntegerCache.low)];
    return new Integer(i);
}
</code></pre>
<p>ã€€ã€€ä»ä¸Šé¢çš„ä»£ç ä¸­ï¼Œå¯ä»¥å‘ç°åœ¨è¯·æ±‚intçš„åŒ…è£…å¯¹è±¡æ—¶ï¼ŒIntegerå†…éƒ¨æœ‰ä¸€ä¸ªå«<code>IntegerCache</code>çš„ç§æœ‰å†…éƒ¨ç±»æ¥åšä¸€éƒ¨åˆ†å¯¹è±¡çš„ç¼“å­˜ã€‚å½“ç¬¬äºŒæ¬¡è¯·æ±‚åŒæ ·æ•´æ•°çš„IntegeråŒ…è£…å¯¹è±¡æ—¶ï¼Œä¼šè¿”å›åŒä¸€ä¸ªå¯¹è±¡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä½¿ç”¨<code>==</code>è¿ç®—ç¬¦æ—¶ï¼Œä¼šè¿”å›trueã€‚è¿™ä¸ªç¼“å­˜åªæœ‰åœ¨ç¬¬ä¸€æ¬¡ä½¿ç”¨æ—¶ï¼Œæ‰ä¼šåˆå§‹åŒ–ã€‚ä»ä»£ç ä¸­å¯ä»¥çœ‹åˆ°æ˜¯ä½¿ç”¨é™æ€ä»£ç å—çš„æ–¹å¼ï¼Œè¿›è¡Œåˆå§‹åŒ–çš„ï¼Œå¹¶ä¸”åªæœ‰é™æ€å­—æ®µã€‚</p>
<p>ã€€ã€€ç¼“å­˜çš„èŒƒå›´é»˜è®¤ä½<strong>-128 ï½ 127</strong>ï¼Œå…¶ä¸­æœ€å¤§å€¼æ˜¯å¯ä»¥é€šè¿‡jvmçš„å¯åŠ¨å‚æ•°<code>-XX:AutoBoxCacheMax</code>æ¥æ§åˆ¶ï¼Œä½†æ˜¯æœ€å°ä¸èƒ½å°äº127ã€‚ä»ä»£ç ä¸­å¯ä»¥çœ‹åˆ°ï¼Œç¼“å­˜æ˜¯é€šè¿‡ä¸€ä¸ªæ•°ç»„æ¥å®ç°çš„ï¼Œå› æ­¤ï¼Œèƒ½å¤Ÿç¼“å­˜çš„æœ€å¤§å€¼ï¼Œç†è®ºä¸Šæ˜¯<code>Integer.MAX_VALUE - 128 - 1</code>ã€‚</p>
<h3 id="-2">å…¶ä»–</h3>
<ul>
<li><p><strong><code>hashcode</code>å‡½æ•°</strong></p>
<pre><code class="java language-java">@Override
public int hashCode() {
    return Integer.hashCode(value);
}
public static int hashCode(int value) {
     return value;
}
</code></pre>
<p>ã€€ã€€Integerå¯¹è±¡çš„hashcodeå‡½æ•°å®ç°çš„éå¸¸ç®€å•ã€‚ä»ä»£ç ä¸­å¯ä»¥çœ‹å‡ºï¼Œæ˜¯ç›´æ¥è¿”å›å®ƒçš„intå€¼çš„ã€‚</p></li>
</ul>
<h3 id="-3">æ€»ç»“</h3>
<p>æœ¬æ–‡è¯¦ç»†åˆ†æäº†JDKä¸­Integerçš„æºä»£ç çš„å¤§éƒ¨åˆ†å®ç°ã€‚å¯ä»¥å‘ç°ï¼Œé‡Œé¢æœ‰å¾ˆå¤šä½¿ç”¨<code>æ‰“è¡¨</code>å’Œ<code>ä½æ“ä½œ</code>æ¥ä¼˜åŒ–çš„æƒ…å†µï¼Œå¾ˆå€¼å¾—å­¦ä¹ ã€‚<br />
æºä»£ç ä¸­è¿˜æœ‰ä¸€äº›ç‰µæ‰¯åˆ°unsignedçš„éƒ¨åˆ†æ²¡æœ‰æ¶‰åŠã€‚</p>
		</div>
	</body>
</html>